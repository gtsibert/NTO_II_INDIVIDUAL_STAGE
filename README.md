# Предсказание рейтингов книг — НТО ИИ (Индивидуальный этап)

Решение задачи предсказания рейтингов книг для пользователей на основе исторических данных.

## Описание задачи

По историческим данным о прочитанных книгах и выставленных оценках необходимо предсказать рейтинг, который пользователь поставит книге.

## Структура данных

Ожидаемые файлы в директории `BASE_DIR`:
- `train.csv` — обучающая выборка (user_id, book_id, has_read, rating)
- `test.csv` — тестовая выборка (user_id, book_id)

## Алгоритм

Решение использует ансамбль из трёх стратегий предсказания:

### 1. Super Predict (вес 35%)
Взвешенное среднее на основе статистик пользователя и книги:
- Среднее, медиана, мин/макс рейтинги
- Учёт «стабильности» пользователя (низкое std)
- Адаптивные веса в зависимости от количества оценок

### 2. Mega Predict (вес 25%)
Медиана нескольких стратегий:
- Средние и медианы по пользователю/книге
- Клиппинг по диапазону оценок пользователя

### 3. Temporal Predict (вес 40%)
Простое взвешенное среднее:
- 60% — среднее по пользователю
- 40% — среднее по книге

### Постобработка
- Значения >= 9.5 округляются до 10
- Финальный клиппинг в диапазон [0, 10]

## Использование

1. Укажите путь к данным в переменной `BASE_DIR`:
```python
BASE_DIR = Path(r"D:\nto_ii_individ")
```

2. Откройте и запустите ноутбук:
```bash
jupyter notebook nto_ii_individ_best_solution.ipynb
```

Выполните все ячейки (Cell → Run All).

3. Результат сохраняется в файл `submission_highclip_95.csv`

## Зависимости

- Python 3.8+
- pandas
- numpy

```bash
pip install pandas numpy
```

## Выходной формат

CSV-файл с колонками:
- `user_id` — идентификатор пользователя
- `book_id` — идентификатор книги
- `rating_predict` — предсказанный рейтинг (0-10)
